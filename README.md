# Mutix

> Mutation testing tool for Elixir

Mutix is a mutation testing tool that generates mutations of your source files
and runs the existing test suite against them.

Generates a mutation report along with a mutation score as the result.

## Installation

Add `:mutix` to your test dependencies in your `mix.exs` file:

```elixir
def deps do
  [
    {:mutix, git: "https://github.com/tuomohopia/mutix.git", tag: "v0.1.0", only: [:dev, :test]}
  ]
end
```

Then add `:test` as the preferred `MIX_ENV` for the mix task of `mutix` in your
`mix.exs` file:

```elixir
def project do
  preferred_cli_env: [
    mutate: :test
  ]
```

Or optionally

```elixir
def cli do
    [preferred_envs: [mutate: :test]]
end
```

## Usage

Use dialyxir from the directory of the mix project you want to analyze; a PLT
file will be created or updated if required and the project will be
automatically compiled.

```bash
mix mutate lib/parser.ex
```

Run `mix help mutate` to see instructions on how to use the tool.

### Command line options

- `--from` - which target operator to mutate
- `--to` - which operator should the target operator be mutated to in the source
  file

If `--from` and `--to` are not defined, `--from` defaults to `+` and `--to` to
`-`.

### Examples

```bash
mix mutate lib/parser.ex --from ">" --to "<"
```

```bash
mix mutate lib/parser.ex --from and --to not
```

#### Example output


<pre style="font-family: monospace; font-size: 12px; padding: 4px; background-color: black; color: white;"><span style="color: cyan;"></span><strong>Results:</strong><text>

    </text><span style="color: blue;"></span><strong>6</strong><text> mutants were generated by mutating ( </text><span style="color: green;">+</span><text> ) into ( </text><span style="color: red;">-</span><text> ).

    </text><span style="color: blue;"></span><strong>4</strong><text> tests were run for each mutant.

    </text><span style="color: green;">0</span><text> / </text><span style="color: blue;"></span><strong>6</strong><text> mutants killed by the test suite.

    Mutation score: </text><span style="color: red;"></span><strong>0.0</strong><text> %

</text><span style="color: magenta;"></span><strong>Surviving mutants</strong><text> - no test failed with these injections:

    </text><span style="color: magenta;">test/support/multi_operator_source.ex</span><text>:</text><span style="color: magenta;">3</span><text> where ( </text><span style="color: green;">+</span><text> ) was mutated into ( </text><span style="color: red;">-</span><text> ):

        def add_one(a) do
</text><span style="color: red;">          a + 1</span><text>
        end

    </text><span style="color: magenta;">test/support/multi_operator_source.ex</span><text>:</text><span style="color: magenta;">7</span><text> where ( </text><span style="color: green;">+</span><text> ) was mutated into ( </text><span style="color: red;">-</span><text> ):

        def add_two(a) do
</text><span style="color: red;">          a + 2</span><text>
        end

    </text><span style="color: magenta;">test/support/multi_operator_source.ex</span><text>:</text><span style="color: magenta;">11</span><text> where ( </text><span style="color: green;">+</span><text> ) was mutated into ( </text><span style="color: red;">-</span><text> ):

        def add_two_and_three(a) do
</text><span style="color: red;">          a + 2 + 3</span><text>
        end

    test/support/multi_operator_source.ex - line 11 where the 2. ( </text><span style="color: green;">+</span><text> ) from left was mutated into ( </text><span style="color: red;">-</span><text> )

        def add_two_and_three(a) do
</text><span style="color: red;">          a + 2 + 3</span><text>
        end

    </text><span style="color: magenta;">test/support/multi_operator_source.ex</span><text>:</text><span style="color: magenta;">15</span><text> where ( </text><span style="color: green;">+</span><text> ) was mutated into ( </text><span style="color: red;">-</span><text> ):

        def non_tested_add(a) do
</text><span style="color: red;">          a + 25</span><text>
        end

    </text><span style="color: magenta;">test/support/multi_operator_source.ex</span><text>:</text><span style="color: magenta;">19</span><text> where ( </text><span style="color: green;">+</span><text> ) was mutated into ( </text><span style="color: red;">-</span><text> ):

        def non_tested_add_2(a) do
</text><span style="color: red;">          a + 25</span><text>
        end


</text></pre>


## Caveats

The current version comes with the following caveats:

- **Macros**: Mutates operators even inside macros. This can lead to very
  confusing results
- **Single source**: Only mutates a single source file at a time. This is
  because producing mutations and running the test suite on each one of them is
  computationally expensive and this is not optimized yet
